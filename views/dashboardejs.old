<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('partials/_head.ejs') %>
    <title>Dashboard</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/bokehButtonStyles.css"> <!-- Added link to bokeh button styles -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"></script>
</head>
<body>
    <%- include('partials/_header.ejs') %>
    <div class="container mt-5">
        <h1>Welcome to Your Dashboard</h1>
        <p>Here you can manage your feedback forms.</p>
        <% if (forms.length > 0) { %>
            <div class="list-group">
                <% forms.forEach(form => { %>
                    <div class="list-group-item list-group-item-action">
                        <span class="form-title"><%= form.title %></span>
                        <div class="float-right action-buttons">
                            <a href="/view-form/<%= form._id %>" class="btn btn-info btn-sm">View</a>
                            <a href="/edit-form/<%= form._id %>" class="btn btn-warning btn-sm">Edit</a>
                            <button onclick="copyToClipboard('<%= form.link %>')" class="btn btn-secondary btn-sm">Share</button>
                            <form action="/delete-form/<%= form._id %>" method="POST" style="display: inline;">
                                <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                                <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete the form \'<%= form.title %>\'? This action cannot be undone.');">Delete</button>
                            </form>
                        </div>
                    </div>
                <% }); %>
            </div>
        <% } else { %>
            <p>You have not created any feedback forms yet.</p>
        <% } %>
    </div>
    <%- include('partials/_footer.ejs') %>
    <script src="/js/dashboardScripts.js"></script>
    <script src="/js/confirmationDialogs.js"></script>
    <script>
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(function() {
                alert('Form link copied to clipboard!');
            }, function(err) {
                console.error('Could not copy text: ', err);
                alert('Failed to copy the link. Please try again.');
            });
        }
    </script>
</body>
</html>